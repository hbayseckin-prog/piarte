{% extends "base.html" %}
{% block title %}Ödeme Düzenle - Piarte{% endblock %}
{% block content %}
<h2>Ödeme Düzenle</h2>

{% if request.session.get('delete_payment_error') %}
<div style="padding:12px 16px;background:#ef4444;color:#fff;border-radius:8px;margin-bottom:16px;">
    {{ request.session.pop('delete_payment_error') }}
</div>
{% endif %}

<form method="post" action="/payments/{{ payment.id }}/update?{% if start %}start={{ start }}&{% endif %}{% if end %}end={{ end }}&{% endif %}{% if course_id %}course_id={{ course_id }}&{% endif %}{% if teacher_id %}teacher_id={{ teacher_id }}&{% endif %}{% if method %}method_filter={{ method }}{% endif %}">
	<label>Öğrenci</label>
	<select name="student_id" required>
		{% for s in students %}
		<option value="{{ s.id }}" {% if payment.student_id == s.id %}selected{% endif %}>{{ s.first_name }} {{ s.last_name }}</option>
		{% endfor %}
	</select>
	<label>Tutar</label>
	<input type="number" name="amount_try" step="0.01" min="0" value="{{ payment.amount_try }}" required />
	<label>Tarih</label>
	<input type="date" name="payment_date" value="{{ payment.payment_date.strftime('%Y-%m-%d') if payment.payment_date else '' }}" />
	<label>Yöntem</label>
	<select name="method">
		<option value="">Seçiniz</option>
		<option value="Nakit" {% if payment.method == 'Nakit' %}selected{% endif %}>Nakit</option>
		<option value="Kart" {% if payment.method == 'Kart' %}selected{% endif %}>Kart</option>
		<option value="EFT" {% if payment.method == 'EFT' %}selected{% endif %}>EFT</option>
	</select>
	<label>Not</label>
	<textarea name="note">{{ payment.note or '' }}</textarea>
	<div style="margin-top:16px;display:flex;gap:12px;">
		<button type="submit">Güncelle</button>
		<a href="/ui/reports/payments?{% if start %}start={{ start }}&{% endif %}{% if end %}end={{ end }}&{% endif %}{% if course_id %}course_id={{ course_id }}&{% endif %}{% if teacher_id %}teacher_id={{ teacher_id }}&{% endif %}{% if method %}method={{ method }}{% endif %}" style="padding:10px 20px;background:#64748b;color:#fff;text-decoration:none;border-radius:8px;display:inline-block;">İptal</a>
	</div>
</form>
{% endblock %}

